# ЛР3 — Создание моделей, миграций и сидеров

Автор: Бизюк Андрей
Дата выполнения: 29 декабря 2025

Цель: Научиться проектировать связи между моделями, использовать фабрики и сидеры.

Кратко
- Реализованы модели: `Post`, `Category`, `Comment`, `Tag`, `Like`.
- Реализованы миграции с внешними ключами и каскадным удалением, pivot `post_tag` и полиморфная таблица `likes`.
- Добавлены фабрики и сидеры — создано наборных данных (посты, теги, комментарии, лайки).
- В `Post` и `Comment` включено мягкое удаление (`softDeletes`).
- Добавлен `CategoryObserver` для автогенерации `slug`.
- Реализован парсинг поля `tags` в `PostController::store`/`update` с `Tag::firstOrCreate`.

Файлы и ключевые изменения
- Модели: [my-personal-blog/app/Models/Post.php](my-personal-blog/app/Models/Post.php), [my-personal-blog/app/Models/Category.php](my-personal-blog/app/Models/Category.php), [my-personal-blog/app/Models/Comment.php](my-personal-blog/app/Models/Comment.php), [my-personal-blog/app/Models/Tag.php](my-personal-blog/app/Models/Tag.php), [my-personal-blog/app/Models/Like.php](my-personal-blog/app/Models/Like.php).
- Миграции: файлы в [my-personal-blog/database/migrations](my-personal-blog/database/migrations) (созданы таблицы `categories`, `tags`, `posts`, `comments`, `post_tag`, `likes`).
- Фабрики: [my-personal-blog/database/factories/PostFactory.php](my-personal-blog/database/factories/PostFactory.php), [my-personal-blog/database/factories/CategoryFactory.php](my-personal-blog/database/factories/CategoryFactory.php), [my-personal-blog/database/factories/CommentFactory.php](my-personal-blog/database/factories/CommentFactory.php), [my-personal-blog/database/factories/TagFactory.php](my-personal-blog/database/factories/TagFactory.php), [my-personal-blog/database/factories/LikeFactory.php](my-personal-blog/database/factories/LikeFactory.php).
- Сидер: [my-personal-blog/database/seeders/DatabaseSeeder.php](my-personal-blog/database/seeders/DatabaseSeeder.php) — создаёт категории, теги, 20 постов с 3 комментариями каждый, привязывает теги и создаёт лайки.
- Observer: [my-personal-blog/app/Observers/CategoryObserver.php](my-personal-blog/app/Observers/CategoryObserver.php) и регистрация в [my-personal-blog/app/Providers/AppServiceProvider.php](my-personal-blog/app/Providers/AppServiceProvider.php).
- Контроллер: [my-personal-blog/app/Http/Controllers/PostController.php](my-personal-blog/app/Http/Controllers/PostController.php) — парсинг `tags` (строка через запятую) и привязка через `firstOrCreate`.

Команды, которые выполнялись

1. Создание моделей/миграций (пример):

`php artisan make:model Post -m`

2. Запуск миграций и сидеров:

`php artisan migrate:fresh --seed`

3. Проверка через Tinker:

`php artisan tinker`

Примеры проверок, выполненные в ходе работы:

`$p = App\\Models\\Post::with('comments','tags','likes')->first();` — дал: `post:1 comments:3 tags:3 likes:0`.

`App\\Models\\Category::create(['name' => 'Тест Категория']);` — observer заполнил `slug`.

Замечания
- Сидер защищён от дублирования: перед созданием проверяется наличие записей.
- UI-формы для создания/редактирования поста (страницы создания) можно добавить отдельно; контроллер готов для приёма поля `tags`.

Вывод
Все требования ЛР3 выполнены: модели, миграции, связи, фабрики, сидеры, полиморфные лайки и observer реализованы и протестированы локально.

---
Файлы с реализацией находятся в каталоге `my-personal-blog` репозитория.
